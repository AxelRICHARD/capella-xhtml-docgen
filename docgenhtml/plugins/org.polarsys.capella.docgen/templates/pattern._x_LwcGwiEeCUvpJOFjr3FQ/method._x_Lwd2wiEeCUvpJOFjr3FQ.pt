<%
super.method_content(new StringBuffer(), ctx);
String elementName = EscapeChars.forHTML(LabelProviderHelper.getText(element));
String elementType = EscapeChars.forHTML(element.eClass().getName());
String projectName= ctx.getValue("projectName").toString();
String outputFolder = ctx.getValue("outputFolder").toString();

Collection<String> involvingFunctionalChains = FunctionHelper.getInvolvingFunctionalChains(projectName, outputFolder, (AbstractFunction)element);
if(involvingFunctionalChains.size() > 0 ) {
%>
<h2>Involving Functional Chains</h2>

<%=StringUtil.stringListToBulette(involvingFunctionalChains)%>
<%
}

Collection<String> allocatingComponents = FunctionHelper.getAllocatingComponents(projectName, outputFolder, (AbstractFunction)element);
if(allocatingComponents.size() > 0 ) {
%>
<h2>Allocating Component</h2>

<%=StringUtil.stringListToBulette(allocatingComponents)%>
<%
}

EList<InputPin> incomingPorts = ((AbstractFunction) element).getInputs();
if(incomingPorts.size() > 0) {
%>
<h2>Incoming Functional Ports</h2>
<%=StringUtil.stringListToBulette(incomingPorts, projectName, outputFolder)%>

<%
}

EList<OutputPin> outgoingPorts = ((AbstractFunction) element).getOutputs();
if(outgoingPorts.size() > 0) {
%>
<h2>Outgoing Functional Ports</h2>
<%=StringUtil.stringListToBulette(outgoingPorts, projectName, outputFolder)%>

<%
}

if(element instanceof AbstractFunction) {
Collection<FunctionalExchange> incomingInteralFunctionalExchanges = CapellaFunctionServices.getIncomingInteralFunctionalExchanges((AbstractFunction)element);
if(incomingInteralFunctionalExchanges.size() > 0) {
%>
    <h2>Incoming Internal Functional Exchanges</h2>
    
    
   <table>
	<tr>
		<th>Exchange</th>
		<th>Involving functional chains</th>
		<th>Allocating component Exchanges</th>
		<th>Distant Port</th>
		<th>Source</th>
		<th>Target</th>
		<th>Description</th>
		<th>Allocated Exchange Items</th>
		<th>Realized Functional Exchange</th>
		<th>Realizing Functional Exchange</th>
	</tr>
<% for(FunctionalExchange functionalExchange : incomingInteralFunctionalExchanges) {%>
	<%=CapellaFunctionServices.externalFunctionalExchangeToTableLine(functionalExchange, projectName, outputFolder)%>
<% }%>
</table>
  <%
}
Collection<FunctionalExchange> outgoingInteralFunctionalExchanges = CapellaFunctionServices.getOutgoingInteralFunctionalExchanges((AbstractFunction)element);
if(outgoingInteralFunctionalExchanges.size() > 0) {
%>
 <h2>Outgoing Internal Functional Exchanges</h2>

    <table>
	<tr>
		<th>Exchange</th>
		<th>Involving functional chains</th>
		<th>Allocating component Exchanges</th>
		<th>Distant Port</th>
		<th>Source</th>
		<th>Target</th>
		<th>Description</th>
		<th>Allocated Exchange Items</th>
		<th>Realized Functional Exchange</th>
		<th>Realizing Functional Exchange</th>
	</tr>
<% for(FunctionalExchange functionalExchange : outgoingInteralFunctionalExchanges) {%>
	<%=CapellaFunctionServices.externalFunctionalExchangeToTableLine(functionalExchange, projectName, outputFolder)%>
<% }%>
</table>
  <%
}
}

Collection<String> availableModeAndState = CapellaFunctionServices.getAvailableModeAndState(projectName,
			outputFolder, (AbstractFunction)element);
			
			if(availableModeAndState.size() > 0) {
%>
<h2>Modes and States</h2>
<%=StringUtil.stringListToBulette(availableModeAndState)%>
<%
}
%>